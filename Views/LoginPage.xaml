<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:GamerLinkApp.ViewModels"
             x:Class="GamerLinkApp.Views.LoginPage"
             x:DataType="vm:LoginViewModel"
             Shell.TabBarIsVisible="False">

    <!-- 背景渐变 -->
    <ContentPage.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#5A63FF" Offset="0" />
            <GradientStop Color="#6E7BFF" Offset="0.28" />
            <GradientStop Color="#F4F5F7" Offset="0.72" />
            <GradientStop Color="#FFFFFF" Offset="1" />
        </LinearGradientBrush>
    </ContentPage.Background>

    <!-- 样式资源 -->
    <ContentPage.Resources>
        <Style x:Key="FormCardStyle" TargetType="Border">
            <Setter Property="Background" Value="#FFFFFF" />
            <Setter Property="Stroke" Value="#EEF0FF" />
            <Setter Property="StrokeThickness" Value="1" />
            <Setter Property="StrokeShape" Value="RoundRectangle 32" />
            <Setter Property="Padding" Value="28,32" />
        </Style>

        <Style x:Key="InputWrapperStyle" TargetType="Border">
            <Setter Property="Stroke" Value="#D9E1FF" />
            <Setter Property="StrokeThickness" Value="1" />
            <Setter Property="StrokeShape" Value="RoundRectangle 16" />
            <Setter Property="Background" Value="#F7F9FF" />
            <Setter Property="Padding" Value="16,12" />
        </Style>

        <Style x:Key="FormEntryStyle" TargetType="Entry">
            <Setter Property="BackgroundColor" Value="Transparent" />
            <Setter Property="TextColor" Value="#1A1A1A" />
            <Setter Property="PlaceholderColor" Value="#9AA3C0" />
            <Setter Property="FontSize">
                <Setter.Value>
                    <OnPlatform x:TypeArguments="x:Double">
                        <On Platform="Android,iOS,MacCatalyst" Value="15" />
                        <On Platform="WinUI" Value="16" />
                    </OnPlatform>
                </Setter.Value>
            </Setter>
            <Setter Property="FontFamily" Value="OpenSansRegular" />
        </Style>

        <Style x:Key="FieldLabelStyle" TargetType="Label">
            <Setter Property="FontSize" Value="13" />
            <Setter Property="TextColor" Value="#586075" />
            <Setter Property="FontAttributes" Value="Bold" />
        </Style>

        <Style x:Key="CardTitleStyle" TargetType="Label">
            <Setter Property="FontSize" Value="22" />
            <Setter Property="TextColor" Value="#1A1A1A" />
            <Setter Property="FontAttributes" Value="Bold" />
        </Style>

        <Style x:Key="CardSubtitleStyle" TargetType="Label">
            <Setter Property="FontSize" Value="14" />
            <Setter Property="TextColor" Value="#76809F" />
        </Style>

        <Style x:Key="PrimaryActionButton" TargetType="Button">
            <Setter Property="HeightRequest">
                <Setter.Value>
                    <OnPlatform x:TypeArguments="x:Double">
                        <On Platform="Android,iOS,MacCatalyst" Value="52" />
                        <On Platform="WinUI" Value="56" />
                    </OnPlatform>
                </Setter.Value>
            </Setter>
            <Setter Property="CornerRadius" Value="18" />
            <Setter Property="FontSize">
                <Setter.Value>
                    <OnPlatform x:TypeArguments="x:Double">
                        <On Platform="Android,iOS,MacCatalyst" Value="16" />
                        <On Platform="WinUI" Value="17" />
                    </OnPlatform>
                </Setter.Value>
            </Setter>
            <Setter Property="FontFamily" Value="OpenSansSemibold" />
            <Setter Property="TextColor" Value="White" />
        </Style>
    </ContentPage.Resources>

    <!-- 主布局 -->
    <Grid>
        <!-- 在 WinUI 上真正居中 -->
        <Grid HorizontalOptions="Center"
              VerticalOptions="Center">
            <ScrollView>
                <VerticalStackLayout>
                    <!-- 平台间距 -->
                    <VerticalStackLayout.Padding>
                        <OnPlatform x:TypeArguments="Thickness">
                            <On Platform="Android,iOS,MacCatalyst" Value="24,72,24,40" />
                            <On Platform="WinUI" Value="48,48,48,48" />
                        </OnPlatform>
                    </VerticalStackLayout.Padding>

                    <VerticalStackLayout.Spacing>
                        <OnPlatform x:TypeArguments="x:Double">
                            <On Platform="Android,iOS,MacCatalyst" Value="28" />
                            <On Platform="WinUI" Value="32" />
                        </OnPlatform>
                    </VerticalStackLayout.Spacing>

                    <!-- 居中或顶部对齐 -->
                    <VerticalStackLayout.HorizontalOptions>
                        <OnPlatform x:TypeArguments="LayoutOptions">
                            <On Platform="Android,iOS,MacCatalyst" Value="Fill" />
                            <On Platform="WinUI" Value="Center" />
                        </OnPlatform>
                    </VerticalStackLayout.HorizontalOptions>

                    <VerticalStackLayout.VerticalOptions>
                        <OnPlatform x:TypeArguments="LayoutOptions">
                            <On Platform="Android,iOS,MacCatalyst" Value="Start" />
                            <On Platform="WinUI" Value="CenterAndExpand" />
                        </OnPlatform>
                    </VerticalStackLayout.VerticalOptions>

                    <!-- 欢迎标题 -->
                    <VerticalStackLayout Spacing="6">
                       
                        <Label Text="使用账号登录，继续探索 GamerLink"
                               FontSize="15"
                               TextColor="#E8EBFF"
                               HorizontalOptions="Center"
                               HorizontalTextAlignment="Center" />
                    </VerticalStackLayout>

                    <!-- 登录卡片 -->
                    <Border Style="{StaticResource FormCardStyle}"
                            HorizontalOptions="Center"
                            WidthRequest="{OnPlatform Android=-1, iOS=-1, MacCatalyst=-1, WinUI=520}">
                        <Border.Shadow>
                            <Shadow Brush="#33512BD4" Offset="0,18" Radius="32" Opacity="0.35" />
                        </Border.Shadow>

                        <VerticalStackLayout Spacing="{OnPlatform Android=24, iOS=24, WinUI=32}">
                            <VerticalStackLayout Spacing="4">
                                <Label Style="{StaticResource CardTitleStyle}" Text="登录您的账号" />
                                <Label Style="{StaticResource CardSubtitleStyle}" Text="请输入账户信息以继续" />
                            </VerticalStackLayout>

                            <VerticalStackLayout Spacing="{OnPlatform Android=18, iOS=18, WinUI=24}">
                                <!-- 用户名 -->
                                <VerticalStackLayout Spacing="6">
                                    <Label Style="{StaticResource FieldLabelStyle}" Text="用户名或邮箱" />
                                    <Border Style="{StaticResource InputWrapperStyle}">
                                        <Entry Text="{Binding Account}"
                                               Style="{StaticResource FormEntryStyle}"
                                               Keyboard="Email"
                                               Placeholder="请输入用户名或邮箱"
                                               ClearButtonVisibility="WhileEditing" />
                                    </Border>
                                </VerticalStackLayout>

                                <!-- 密码 -->
                                <VerticalStackLayout Spacing="6">
                                    <Label Style="{StaticResource FieldLabelStyle}" Text="密码" />
                                    <Border Style="{StaticResource InputWrapperStyle}">
                                        <Entry Text="{Binding Password}"
                                               Style="{StaticResource FormEntryStyle}"
                                               IsPassword="True"
                                               Placeholder="请输入密码" />
                                    </Border>
                                </VerticalStackLayout>
                            </VerticalStackLayout>

                            <!-- 错误提示 -->
                            <Label Text="{Binding ErrorMessage}"
                                   TextColor="#E04E5B"
                                   FontSize="13"
                                   IsVisible="{Binding HasError}" />

                            <!-- 登录按钮 -->
                            <Button Text="登录"
                                    Command="{Binding LoginCommand}"
                                    Style="{StaticResource PrimaryActionButton}"
                                    IsEnabled="{Binding CanLogin}">
                                <Button.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Color="#5B61FF" Offset="0" />
                                        <GradientStop Color="#7C8FFF" Offset="1" />
                                    </LinearGradientBrush>
                                </Button.Background>
                                <Button.Shadow>
                                    <Shadow Brush="#305B61FF" Offset="0,10" Radius="24" Opacity="0.45" />
                                </Button.Shadow>
                            </Button>

                            <!-- 注册提示 -->
                            <HorizontalStackLayout HorizontalOptions="Center" Spacing="6">
                                <Label Text="还没有账号？"
                                       FontSize="13"
                                       TextColor="#6D6F7C" />
                                <Label Text="立即注册"
                                       FontSize="13"
                                       FontAttributes="Bold"
                                       TextColor="#5B61FF">
                                    <Label.GestureRecognizers>
                                        <TapGestureRecognizer Tapped="OnRegisterTapped" />
                                    </Label.GestureRecognizers>
                                </Label>
                            </HorizontalStackLayout>
                        </VerticalStackLayout>
                    </Border>
                </VerticalStackLayout>
            </ScrollView>
        </Grid>
    </Grid>
</ContentPage>
