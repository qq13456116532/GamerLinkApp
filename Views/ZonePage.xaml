<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:GamerLinkApp.ViewModels"
             x:Class="GamerLinkApp.Views.ZonePage"
             x:DataType="vm:ZoneViewModel"
             Title="Game Zone"
             BackgroundColor="#FFFFFF">
    <Grid ColumnDefinitions="140,*">
        <Border Grid.Column="0"
                Padding="0,24,0,0"
                BackgroundColor="#F5F6F8"
                StrokeThickness="0">
            <CollectionView ItemsSource="{Binding Games}"
                            SelectionMode="Single"
                            SelectedItem="{Binding SelectedGame, Mode=TwoWay}"
                            Margin="0"
                            BackgroundColor="Transparent">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Vertical"
                                       ItemSpacing="0" />
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="x:String">
                        <Grid ColumnDefinitions="6,*"
                              Padding="0,14"
                              BackgroundColor="Transparent">
                            <BoxView x:Name="SelectionIndicator"
                                     WidthRequest="6"
                                     BackgroundColor="Transparent"
                                     HorizontalOptions="Fill"
                                     VerticalOptions="Fill" />
                            <Label x:Name="GameLabel"
                                   Grid.Column="1"
                                   Text="{Binding .}"
                                   FontSize="16"
                                   TextColor="#5F6473"
                                   VerticalOptions="Center"
                                   Padding="18,0"
                                   LineBreakMode="TailTruncation" />
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup Name="SelectionStates">
                                    <VisualState Name="Normal">
                                        <VisualState.Setters>
                                            <Setter TargetName="SelectionIndicator"
                                                    Property="BoxView.BackgroundColor"
                                                    Value="Transparent" />
                                            <Setter TargetName="GameLabel"
                                                    Property="Label.TextColor"
                                                    Value="#5F6473" />
                                            <Setter TargetName="GameLabel"
                                                    Property="Label.FontAttributes"
                                                    Value="None" />
                                            <Setter Property="BackgroundColor"
                                                    Value="Transparent" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState Name="Selected">
                                        <VisualState.Setters>
                                            <Setter TargetName="SelectionIndicator"
                                                    Property="BoxView.BackgroundColor"
                                                    Value="#3478F6" />
                                            <Setter TargetName="GameLabel"
                                                    Property="Label.TextColor"
                                                    Value="#3478F6" />
                                            <Setter TargetName="GameLabel"
                                                    Property="Label.FontAttributes"
                                                    Value="Bold" />
                                            <Setter Property="BackgroundColor"
                                                    Value="#EAF1FF" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Border>

        <VerticalStackLayout Grid.Column="1"
                              Padding="32,24"
                              Spacing="24"
                              BackgroundColor="#FFFFFF">
            <Label Text="{Binding SelectedGame, FallbackValue='Game Zone'}"
                   FontSize="22"
                   FontAttributes="Bold"
                   TextColor="#1F1F1F" />

            <Label Text="No services available"
                   FontSize="14"
                   TextColor="#8E94A2"
                   HorizontalOptions="Center"
                   IsVisible="False">
                <Label.Triggers>
                    <DataTrigger TargetType="Label"
                                 Binding="{Binding HighlightedService}"
                                 Value="{x:Null}">
                        <Setter Property="IsVisible" Value="True" />
                    </DataTrigger>
                </Label.Triggers>
            </Label>

            <Border Padding="16"
                    BackgroundColor="#FFFFFF"
                    StrokeThickness="1"
                    Stroke="#E5E7EB"
                    IsVisible="True">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="16" />
                </Border.StrokeShape>
                <Border.Triggers>
                    <DataTrigger TargetType="Border"
                                 Binding="{Binding HighlightedService}"
                                 Value="{x:Null}">
                        <Setter Property="IsVisible" Value="False" />
                    </DataTrigger>
                </Border.Triggers>
                <Grid ColumnDefinitions="Auto,*"
                      ColumnSpacing="16">
                    <Border WidthRequest="84"
                            HeightRequest="84"
                            StrokeThickness="0"
                            BackgroundColor="#F2F4F8">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="12" />
                        </Border.StrokeShape>
                        <Image Source="{Binding HighlightedService.ThumbnailUrl}"
                               Aspect="AspectFill" />
                    </Border>
                    <VerticalStackLayout Grid.Column="1"
                                          Spacing="8"
                                          VerticalOptions="Center">
                        <Label Text="{Binding HighlightedService.Title}"
                               FontSize="16"
                               FontAttributes="Bold"
                               TextColor="#1F1F1F"
                               LineBreakMode="TailTruncation" />
                        <Label Text="{Binding HighlightedService.PurchaseCount, StringFormat='Sold {0}'}"
                               FontSize="12"
                               TextColor="#8E94A2" />
                        <Label Text="{Binding HighlightedService.Price, StringFormat='{0:C0}'}"
                               FontSize="18"
                               FontAttributes="Bold"
                               TextColor="#E53935" />
                    </VerticalStackLayout>
                </Grid>
            </Border>
        </VerticalStackLayout>
    </Grid>
</ContentPage>
