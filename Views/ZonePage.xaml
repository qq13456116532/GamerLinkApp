<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:GamerLinkApp.ViewModels"
             xmlns:models="clr-namespace:GamerLinkApp.Models"
             x:Class="GamerLinkApp.Views.ZonePage"
             x:DataType="vm:ZoneViewModel"
             Title="Game Zone"
             BackgroundColor="#F3F4F8">
    <Grid RowDefinitions="Auto,*">
        <Border Grid.Row="0"
                Margin="20,20,20,16"
                Padding="24"
                StrokeThickness="0">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="24" />
            </Border.StrokeShape>
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#5B61FF" Offset="0" />
                    <GradientStop Color="#6C4CFF" Offset="1" />
                </LinearGradientBrush>
            </Border.Background>
            <Grid ColumnDefinitions="*,Auto" ColumnSpacing="20">
                <VerticalStackLayout Spacing="6">
                    <Label Text="{Binding HighlightedService.GameName, FallbackValue='Discovery Zone'}"
                           FontSize="22"
                           FontAttributes="Bold"
                           TextColor="White" />
                    <Label Text="{Binding HighlightedService.Title, FallbackValue='Find curated services for your next session'}"
                           FontSize="14"
                           TextColor="#E4E7FF"
                           LineHeight="1.2" />
                </VerticalStackLayout>
                <VerticalStackLayout Grid.Column="1"
                                      Spacing="8"
                                      HorizontalOptions="End"
                                      VerticalOptions="Center">
                    <Label Text="{Binding HighlightedService.Price, StringFormat='CNY {0:F0}'}"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="#FFFFFF"
                           HorizontalTextAlignment="End" />
                    <Border BackgroundColor="#FFFFFF"
                            Padding="18,8"
                            StrokeThickness="0"
                            HorizontalOptions="End">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="18" />
                        </Border.StrokeShape>
                        <Label Text="Explore Now"
                               FontAttributes="Bold"
                               TextColor="#483CFF"
                               HorizontalOptions="Center"
                               HorizontalTextAlignment="Center" />
                    </Border>
                </VerticalStackLayout>
            </Grid>
        </Border>

        <Grid Grid.Row="1"
              ColumnDefinitions="150,*"
              ColumnSpacing="16"
              Margin="20,0,20,20">
            <Border Grid.Column="0"
                    Padding="16,18"
                    BackgroundColor="White"
                    Stroke="#E0E4FF"
                    StrokeThickness="1">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="22" />
                </Border.StrokeShape>
                <Border.Shadow>
                    <Shadow Brush="#14000000"
                            Offset="0,6"
                            Radius="10" />
                </Border.Shadow>
                <VerticalStackLayout Spacing="14">
                    <Label Text="Games"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="#1F1F1F" />
                    <CollectionView ItemsSource="{Binding Games}"
                                    SelectionMode="Single"
                                    SelectedItem="{Binding SelectedGame, Mode=TwoWay}"
                                    Margin="0"
                                    BackgroundColor="Transparent">
                        <CollectionView.ItemsLayout>
                            <LinearItemsLayout Orientation="Vertical"
                                               ItemSpacing="8" />
                        </CollectionView.ItemsLayout>
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="x:String">
                                <Border Padding="14,12"
                                        StrokeThickness="1"
                                        Stroke="#E4E6F8"
                                        BackgroundColor="#F8F9FF">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="14" />
                                    </Border.StrokeShape>
                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup Name="CommonStates">
                                            <VisualState Name="Normal" />
                                            <VisualState Name="Selected">
                                                <VisualState.Setters>
                                                    <Setter Property="BackgroundColor" Value="White" />
                                                    <Setter Property="Stroke" Value="#5B61FF" />
                                                    <Setter Property="Shadow">
                                                        <Setter.Value>
                                                            <Shadow Brush="#21000000"
                                                                    Offset="0,6"
                                                                    Radius="12" />
                                                        </Setter.Value>
                                                    </Setter>
                                                </VisualState.Setters>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>
                                    <Label Text="{Binding .}"
                                           FontSize="15"
                                           FontAttributes="Bold"
                                           TextColor="#1A1A1A" />
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Border>

            <ScrollView Grid.Column="1">
                <VerticalStackLayout Padding="8,0,0,24"
                                      Spacing="20">
                    <Border BackgroundColor="White"
                            Padding="18"
                            StrokeThickness="0">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="22" />
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="#16000000"
                                    Offset="0,8"
                                    Radius="14" />
                        </Border.Shadow>
                        <Grid ColumnDefinitions="Auto,*"
                              ColumnSpacing="18">
                            <Border WidthRequest="96"
                                    HeightRequest="96"
                                    StrokeThickness="0"
                                    BackgroundColor="#F0F2FF">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="18" />
                                </Border.StrokeShape>
                                <Image Source="{Binding HighlightedService.ThumbnailUrl}"
                                       Aspect="AspectFill" />
                            </Border>
                            <VerticalStackLayout Grid.Column="1"
                                                  Spacing="8"
                                                  VerticalOptions="Center">
                                <Label Text="{Binding HighlightedService.Title}"
                                       FontSize="18"
                                       FontAttributes="Bold"
                                       TextColor="#1A1A1A"
                                       LineBreakMode="WordWrap" />
                                <Label Text="{Binding HighlightedService.Description}"
                                       FontSize="13"
                                       TextColor="#6F7583"
                                       LineHeight="1.3"
                                       MaxLines="3" />
                                <Grid ColumnDefinitions="Auto,Auto"
                                      ColumnSpacing="14">
                                    <Label Text="{Binding HighlightedService.Price, StringFormat='CNY {0:F0}'}"
                                           FontSize="16"
                                           FontAttributes="Bold"
                                           TextColor="#483CFF" />
                                    <Border Grid.Column="1"
                                            BackgroundColor="#483CFF"
                                            Padding="18,8"
                                            StrokeThickness="0"
                                            HorizontalOptions="End">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="18" />
                                        </Border.StrokeShape>
                                        <Label Text="Book Now"
                                               FontAttributes="Bold"
                                               TextColor="White"
                                               HorizontalOptions="Center"
                                               HorizontalTextAlignment="Center" />
                                    </Border>
                                </Grid>
                            </VerticalStackLayout>
                        </Grid>
                    </Border>

                    <Label Text="Recommended Services"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="#1F1F1F"
                           Margin="4,0,0,0" />

                    <CollectionView ItemsSource="{Binding Services}"
                                    SelectionMode="None">
                        <CollectionView.ItemsLayout>
                            <LinearItemsLayout Orientation="Vertical"
                                               ItemSpacing="16" />
                        </CollectionView.ItemsLayout>
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:Service">
                                <Border Padding="16"
                                        BackgroundColor="White"
                                        Stroke="#EAECF5"
                                        StrokeThickness="1">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="20" />
                                    </Border.StrokeShape>
                                    <Border.Shadow>
                                        <Shadow Brush="#12000000"
                                                Offset="0,6"
                                                Radius="10" />
                                    </Border.Shadow>
                                    <Grid ColumnDefinitions="Auto,*"
                                          ColumnSpacing="16">
                                        <Border WidthRequest="76"
                                                HeightRequest="76"
                                                StrokeThickness="0"
                                                BackgroundColor="#F1F3FF">
                                            <Border.StrokeShape>
                                                <RoundRectangle CornerRadius="16" />
                                            </Border.StrokeShape>
                                            <Image Source="{Binding ThumbnailUrl}"
                                                   Aspect="AspectFill" />
                                        </Border>
                                        <VerticalStackLayout Grid.Column="1"
                                                              Spacing="6"
                                                              VerticalOptions="Center">
                                            <Label Text="{Binding Title}"
                                                   FontSize="16"
                                                   FontAttributes="Bold"
                                                   TextColor="#1A1A1A"
                                                   LineBreakMode="TailTruncation" />
                                            <Grid ColumnDefinitions="Auto,Auto"
                                                  ColumnSpacing="12">
                                                <Label Text="{Binding Price, StringFormat='CNY {0:F0}'}"
                                                       FontSize="15"
                                                       FontAttributes="Bold"
                                                       TextColor="#483CFF" />
                                                <Label Grid.Column="1"
                                                       Text="{Binding PurchaseCount, StringFormat='Purchased {0}'}"
                                                       FontSize="12"
                                                       TextColor="#7C8397"
                                                       HorizontalOptions="End" />
                                            </Grid>
                                        </VerticalStackLayout>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </ScrollView>
        </Grid>
    </Grid>
</ContentPage>
